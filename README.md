# 🚀 XiaoZhi-ESP32-P4 AI 语音助手

### JC4880P443 深度适配版

本项目基于 [XiaoZhi-ESP32](https://github.com/78/xiaozhi-esp32) 框架，针对 **Guition JC4880P443**（4.3 寸 · 480×800 · MIPI DSI）开发板进行深度适配与二次开发。

目标： **在 ESP32-P4 平台上构建集语音、视觉、多媒体与环境感知于一体的 AI 智能终端。**

---

## 📖 项目简介

本项目基于 **ESP32-P4 MCU**，结合：

- MIPI DSI 高速显示屏
- 音频 Codec（ES8311）
- 摄像头（OV2640 / OV5640）
- 环境传感器（温湿度 / 气压）

实现以下能力：

- 🎙 AI 语音交互（支持打断）
- 🎵 本地多媒体播放
- 🌡 环境数据实时展示
- 📷 AI 视觉与识物

---

## 🧱 UI 功能布局示意

```
+------------------------------------------+
| [ WiFi ]          10:45 AM               |
+------------------------------------------+
|                                          |
| [ Row 1: 天气 / 环境气象站               ] |
|                                          |
+------------------------------------------+
|                    |                     |
| [ Row 2-L: 音乐 ]  | [ Row 2-R: 相册 ]   |
|                    |                     |
+------------------------------------------+
|                                          |
| [ Row 3: 本地视频播放器                 ] |
|                                          |
+------------------------------------------+
|                    |                     |
| [ Row 4-L: 摄像头 ]| [ Row 4-R: 设置 ]   |
|                    |                     |
+------------------------------------------+
|   +--------+                             |
|   | Emoji  |   “你好，请问有什么可以     |
|   |  Box   |    帮您的吗？”              |
|   +--------+                             |
+------------------------------------------+
```

---

## 🛠 硬件规格

### 核心芯片

- **ESP32-P4+C6**

### 显示与交互

- **屏幕**：4.3 寸 MIPI DSI 480×800（ST7701）
- **触摸**：GT911（I2C）

### 音频

- **Audio Codec**：ES8311（I2S，全双工）

### 外设

- 摄像头：OV2640 / OV5640
- 传感器：BME280 / AHT20
- 物理按键：BOOT（配网 / 调试）
- 虚拟按键：Emoji Box（核心交互）

---

## 🚦 工程进度（Roadmap）

### 第一阶段：BSP 适配（已完成）
[x] MIPI DSI 驱动: 适配 ST7701 480x800 初始化序列。

[x] 音频系统: 实现 ES8311 全双工语音对话。

[x] 触摸系统: 完成 GT911 驱动与 LVGL 坐标映射。

[x] 显示框架: 移植 LVGL 8.3.x 异步渲染。


### 第二阶段：UI 与交互（已完成）

[x] 多卡片布局: 实现 1-2-1-2-混合布局容器。

[x] 交互逻辑: 实现 PTT (按住说话) 与单击打断逻辑。

[x] 后台心跳: 建立独立 LVGL 任务，确保 UI 响应丝滑。

### 第三阶段：多媒体与感知（进行中）

[ ] 本地播放器: 开发基于 SPIFFS/SD 卡的本地视频 (MJPEG) 与音乐播放功能。

[ ] AI 视觉: 集成摄像头驱动，实现本地拍照、相册浏览及云端 AI 识物。

[ ] 环境气象站: 实时读取传感器数据，动态更新首页环境卡片。

### 第四阶段：网络与 AI（计划中）

[ ] OTA 升级: 实现通过 Web 界面进行固件远程更新。

[ ] 性能调优: 使用 PSRAM 优化多媒体缓冲区，提升视频播放帧率。
---

## 🏗 软件架构

```
main/
├── boards/      # 板级支持包（jc4880p443.cc）
├── display/     # UI 与卡片组件
├── media/       # 视频 / 音乐 / 相册
├── sensors/     # 传感器数据采集
```

---

## 🎮 交互指南

| 操作       | 功能   | 说明             |
| -------- | ---- | -------------- |
| 长按 Emoji | 开始聆听 | StartListening |
| 松开 Emoji | 停止聆听 | StopListening  |
| 单击 Emoji | 打断   | 中断语音 / 音乐      |
| 点击卡片     | 打开应用 | 多媒体 / 相册       |
| 点击 BOOT  | 坐标调试 | 串口输出 X / Y     |

